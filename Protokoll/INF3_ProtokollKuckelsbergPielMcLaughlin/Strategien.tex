\section*{Strategien und Kommunikation}

\subsection*{Client}




\subsection*{Server}

\subsection*{Protokoll Server}
Zur Kommunikation zwischen Server und Client läuft nach folgendem Protokoll ab.\\
\includegraphics[scale=0.5]{Screenshot_2022-01-12 Commits · karuku97 INF3_Schiffe.png}
\\
\subsubsection*{Strategien}
Zum beschießen des erzeugten Spielfelds werden (hier finale Anzahl einfügen) unterschiedliche Strategien verwendet.

\subsubsection*{Bruteforce}

\subsubsection*{BruteforceDiagonal}

\subsubsection*{Randshoot}

Bei dieser Strategie wird mittels der rand()-Funktion die Koordinaten von 1 bis 10 für
beide per Zufall ausgewählt und eine Anfrage mit diesen beliebigen Koordinaten an den
Server geschickt. Doppelungen von Anfragen oder mehr als zweimal können auftreten,
da nicht gespeichert wird, ob das Feld bereits angefragt wurde oder nicht.

\subsubsection*{RandshootiS}

Diese Strategie ist die Erweiterung zu der randshoot-Strategie. Die Generierung der
Koordinaten erfolgt wie bei der ersten Strategie. Ergänzend hinzugekommen ist, dass
diese Strategie die Anfragen in einem zweidimensionalen Feld abspeichert und nach
einer erneuten Generierung prüft, ob diese Koordinaten bereits angefragt wurden. Ist
dies der Fall, werden neue Koordinaten generiert. Es erfolgt dann keine neue Anfrage an
den Server bei bereits angefragten Koordinaten, die bereits vorher schon angefragt
wurden. Fällt das Ergebnis dieser Anfragen negativ aus, so wird eine Anfrage an den
Server gestellt. Wird eine Anfrage gestellt, wird der Wert der Koordinaten in der Matrix
(2D-Feld) gemäß der boolschen Wahrheitswerte von „false“ auf „true“ geändert.

\subsubsection*{Intellistrat}

\subsubsection*{IntellistratDiagonal}

\subsection*{Spielfeldverwaltung}

Die SpielFeldverwaltung setzt sich aus folgenden Funktionen und einer Klasse zusammen,
void restart, enum Feldstatus, string shootPos, Feldstatus shootline, Feldstatus Nachbar und der Klasse SpielfeldVerwaltung.
Die Funktion restart wird vom Client benötigt um dem Server mitzuteilen dass das Spiel neugestartet werden soll und shootpos wird verwendet um dem Server mitzuteilen auf welches Feld geschossen werden soll und gibt den Antwortstring des Servers zurück. Unter Feldstatus sind die Enums gespeichert die von der Klasse Spielfeldverwaltung benutzt werden, Erklärung folgt. Die Funktionen Nachbar und Shootline suchen und zerstören ein Schiff komplett wenn ein Treffer gelandet wurde. Sie Funktionieren nach dem Prizip der Funktion Neigbour welche in der Datei Intellistrat.C verwendet wird und machen sich die Methoden der Klasse zur nutze. Wird ein Schiff getroffen so wird die Funktion Nachbar aufgerufen, sie benötigt als Übergabeparameter die x- und die y- Koordinate die Anzahl der gezählten Schritte , den TCPclient und eine Referenz auf die aktuelle Instanz der Klasse. Dann wird viermal die Funktion Shootline aufgerufen, Shootline benötigt die eben genennte Übergabeparameter und zusätzlich noch zwei Additionsvariablen. In der Funktion werden dann die Additionsvariablen in einer do-while Schleife auf die x- und y- Variablen draufaddiert, solange der Server ShipHit als Rückgabe liefert. Dies führt dazu das in eine Richtung geschossen wird. Wenn Wasser als Rückgabewert kommt wird die Funktion beendet und Nachbar ruft Shootline solange auf bis alle vier Richtungen ausprobiert wurden, bzw. Bis das Schiff zerstört wurde, tritt dies schon nach dem ersten aufgerufen von Shootline auf wird die Funktion Nachbar ebenfalls beendet.

Die gleichnahmige Klasse SpielfeldVerwaltung besitz ein \newline eindimensionales Array Spielfeld mit 100 Variablen des Typs Enum
(die dazugehörigen Enums sind ausserhalb der Klasse definiert), die integer Variablen lastX, lastY, lastPos und die Funktionen CoordsToPosition, int SpielfeldPositionToCoordsX, SpielfeldPositionToCoordsY, SchiffePositionToCoordsX, SchiffePositionToCoordsY, getFieldstatus, getLastFieldStatus, Statusreport, SchiffPosition, ServerStringToEnum.\newline 
Die Funktionen CoordsToPosition, int SpielfeldPositionToCoordsX, SpielfeldPositionToCoordsY, SchiffePositionToCoordsX, SchiffePositionToCoordsY, getFieldstatus, searchShipclass leifern einen Rückgabewert des Typs Integer. 
Statusreport, SchiffPosition liefern keinen Rückgabewert und Serverstring toEnum liefert einen Enum als Rückgabewert. 
Das eindimensionale Array Spielfeld, welches in der Klasse protected ist, ist dafür da um den Status des beschossenen Feldes zu Speichern in dem ein Enum mit folgende Möglichkeiten NICHT\_BESCHOSSEN = 0, WASSER = 1, SCHIFF\_GETROFFEN = 2, SCHIFF\_ZERSTOERT = 3, GAMEOVER = 4, ERROR = -1 auf die gerade beschossene Stelle schreibt, standartmäßig sind alle Positionen mit NICHT\_BESCHOSSEN = 0 beschrieben und werden dann überschrieben. Ermöglicht wird das durch die Funktionen Statusreport und ServerStringToEnum. Wenn die Funktion Statusreport aufgerufen wird muss ihr die aktuelle Position in Form von einer x- und einer y-Variablen und den String den der Server beim Beschuss dieses Feldes als Antwort zurückgibt übergeben werden. Nach der Übergabe der Parameter werden die übergebenen x- und y- Koordinaten in lastX und lastY gespeichert, damit in der Klasse immer die aktuelle Position des gerade laufenden Spiels gespeichert ist. Ebenfalls werden die x- und y- Werte von der Funktion CoordsToPosition zusammengerechnet und in der Variablen lastPos gespeichert, diese Variable gibt auskunft über die aktuelle Position auf dem eindimensionalen Array. Die Funktion CoordsToPosition, welche protectedist, berechnet ((y-1) * 10) + x-1 und gibt die Lösung zurück. Dann wird die aktuelle Position des Arrays beschrieben, dafür wird auf der Position die mit lastPos festgelegt wurde die Funktion ServerStringToEnum aufgerufen und der String den der Server geschickt hat übergeben. Als Rückgabewert liefert diese Funktion einen des Strings entsprecheden Enum, welcher im Array gespeichert wird. dieser komplette Vorgang wird bei jedem Schuss ausgeführt um eine übersicht über den Spielfortschritt zu haben, um ein doppeltes Beschiessen eines Feldes zu verhindern und um zusätzliche Funktionen wie die Nachbar-Funktion zu ermöglichen. Weitere Funktionen der Klasse sind getFieldstatus, welche als Eingabewerte die aktuelle x- und y- Koordinate benötigt und als Rückgabewert den Enum der auf dieser Position im Array steht liefert. Dies Funktioniert ähnlich wie bei der Funktion Statusreport mit der Funktion CoordsToPosition, in diesem Fall wird das Array nicht beschrieben sondern den Wert der Position zurückgegben. Die Funktion getLastFieldStatus funktioniert identisch, nur erwartet sie keine Eingabewerte sondern nutzt als x- und y- Koordinate das was in den Variablen lastX und lastY gespeichert wurde, der Rückgabewert ist dann wieder der Wert des Arrays an dieser Position. Weitere Funktionen sind SchiffePositionToCoordsX und SpielfeldPositionToCoordsY, beide sind identisch sie erwarten als Eingabewert die aktuelle Position auf dem Array und rechnen dann jeweils die x- oder y- Koordinate aus und geben diese zurück, dies ist vorallem beim Debugging sehr hilfreich.


Erklärung der einzelnen Strategien, was unterscheidet die Ideen
Protokoll Server Client Kommunikation